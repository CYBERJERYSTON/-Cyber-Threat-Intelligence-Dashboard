<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CTI Dashboard - Result</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <style>
        body { background-color: #f8f9fa; font-family: "Segoe UI", Arial, sans-serif; }
        .card { border-radius: 12px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .key { font-weight: bold; color: #0d6efd; }
        .value { font-family: monospace; }
        .harmless { color: green; }
        .malicious { color: red; font-weight: bold; }
        .undetected { color: gray; }
    </style>
</head>
<body>
<div class="container mt-5">
    <h2 class="mb-4 text-center">üîç Threat Intelligence Lookup Result</h2>

    <div class="card p-4">
        <p><span class="key">IOC:</span> <span class="value">{{ result['ioc'] }}</span></p>
        <p><span class="key">Source:</span> {{ result['source'] }}</p>
        <p><span class="key">Timestamp:</span> {{ result['timestamp'] }}</p>
        <p><span class="key">AbuseIPDB Score:</span> {{ result['abuseipdb_score'] }}</p>

        <h4 class="mt-4">üõ°Ô∏è VirusTotal Engines</h4>
        {% if result['virustotal'].get('data') %}
            <ul class="list-group">
                {% for engine, details in result['virustotal']['data']['attributes']['last_analysis_results'].items() %}
                    <li class="list-group-item">
                        <span class="key">{{ engine }}</span> ‚Üí
                        <span class="{{ details['category'] }}">
                            {{ details['result'] if details['result'] else "Clean" }}
                        </span>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="text-muted">‚ö†Ô∏è No VirusTotal data available (possibly private IP or resource not found).</p>
        {% endif %}
    </div>
</div>
</body>
</html>
